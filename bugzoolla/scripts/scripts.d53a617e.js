"use strict";angular.module("bugzoollaApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/dash.html",controller:"DashCtrl",controllerAs:"dash"}).when("/search",{templateUrl:"views/dash.html",controller:"DashCtrl",controllerAs:"dash"}).when("/bug/:id",{templateUrl:"views/bug.html",controller:"BugCtrl",controllerAs:"bug"}).when("/about",{templateUrl:"views/about.html",controller:"AboutCtrl",controllerAs:"about"}).otherwise({redirectTo:"/"})}]),angular.module("bugzoollaApp").factory("BugFactory",["$resource",function(a){return a("https://bugzilla.mozilla.org/rest/bug/:id",{id:"@_id"},{query:{isArray:!1}})}]).factory("CommentFactory",["$resource",function(a){return a("https://bugzilla.mozilla.org/rest/bug/:bug_id/comment",{bug_id:"@_bug_id"},{query:{isArray:!1}})}]),angular.module("bugzoollaApp").controller("NavCtrl",["$scope","$location",function(a,b){a.isActive=function(a){return a===b.path()}}]),angular.module("bugzoollaApp").controller("AboutCtrl",function(){}),angular.module("bugzoollaApp").controller("DashCtrl",["$scope","$cookies","$routeParams","$location","BugFactory","CommentFactory",function(a,b,c,d,e,f){a.loading_status="thinking...",c.assignee||c.reporter||c.component||c.whiteboard||c.modified_after||c.created_after?a.search={modified_after:c.modified_after?new Date(c.modified_after):void 0,created_after:c.created_after?new Date(c.created_after):void 0,assignee:c.assignee,reporter:c.reporter,component:c.component,whiteboard:c.whiteboard}:a.search={modified_after:b.get("search.modified_after")?new Date(b.get("search.modified_after")):void 0,created_after:b.get("search.created_after")?new Date(b.get("search.created_after")):void 0,assignee:b.get("search.assignee"),reporter:b.get("search.reporter"),component:b.get("search.component"),whiteboard:b.get("search.whiteboard")},a.setSearchCookies=function(){for(var c in a.search)a.search.hasOwnProperty(c)&&(d.search(c,null),a.search[c]?a.search[c]instanceof Date?b.put("search."+c,a.search[c].toISOString().substring(0,10)):b.put("search."+c,a.search[c]):b.remove("search."+c))},a.refresh=function(b){a.search.advanced=a.search.reporter||a.search.component||a.search.whiteboard||a.search.created_after,b.$valid&&(a.setSearchCookies(),a.count=0,a.loading_status="talking to bugzilla...",e.query({assigned_to:a.search.assignee,last_change_time:a.search.modified_after,creation_time:a.search.created_after,creator:a.search.reporter,component:a.search.component,whiteboard:a.search.whiteboard},function(b){a.bugs={backlog:[],has_comments:[],has_patches:[],resolved:[]},a.count=b.bugs.length,a.processed=0,a.loading_status="sorting bugs...",b.bugs.forEach(function(b){b.whiteboard&&(b.tags=b.whiteboard.split(/[\[\],]+/).filter(function(a){return void 0!=a&&a})),b.hidden=!0,b.is_open&&b.is_open?f.get({bug_id:b.id},function(c){c.bugs[b.id].comments.filter(function(a){return a.attachment_id}).length?(a.processed++,a.bugs.has_patches.push(b)):c.bugs[b.id].comments.length>1?(a.processed++,a.bugs.has_comments.push(b)):(a.processed++,a.bugs.backlog.push(b))}):(a.processed++,a.bugs.resolved.push(b))}),a.setVisibility=function(b,c){a.bugs[b].forEach(function(a){a.hidden=c})}}))},a.$watch("processed",function(b){b===a.count&&(a.loading_status=!1)}),a.$watch("bugSearch",function(b){b&&a.refresh(b)})}]),angular.module("bugzoollaApp").controller("BugCtrl",["$scope","$routeParams","BugFactory","CommentFactory",function(a,b,c,d){c.get({id:b.id},function(c){a.bug=c.bugs[0],d.get({bug_id:b.id},function(c){a.bug.comments=c.bugs[b.id].comments})})}]),angular.module("bugzoollaApp").directive("bugPanel",function(){return{templateUrl:"views/bug-panel.html",restrict:"E",scope:{verbose:"@",bug:"="},link:function(a,b,c){var d=c.verbose;(null===d||void 0===d||""===d)&&(d=!1)}}}),angular.module("bugzoollaApp").directive("bugsPanel",function(){return{templateUrl:"views/bugs-panel.html",restrict:"E",scope:{title:"@",bugs:"="},link:function(a,b,c){}}}),angular.module("bugzoollaApp").directive("commentPanel",function(){return{templateUrl:"views/comment-panel.html",restrict:"E",scope:{index:"@",comment:"="},link:function(a,b,c){}}}),angular.module("bugzoollaApp").directive("gravatar",["md5",function(a){return{restrict:"EAC",link:function(b,c,d){b.$watch(d.email,function(b){if(null!==b&&void 0!==b&&""!==b){var e=a.createHash(b.toLowerCase()),f=d.size;(null===f||void 0==f||""==f)&&(f=40);var g=d.rating;(null===g||void 0===g||""===g)&&(g="pg");var h=d["default"];(null===h||void 0===h||""===h)&&(h="404");var i='<img alt="" src="http://www.gravatar.com/avatar/'+e+"?s="+f+"&r="+g+"&d="+h+'" />';c.append(i)}})}}}]),angular.module("bugzoollaApp").factory("md5",[function(){var a={createHash:function(a){var b,c,d,e,f,g,h,i,j,k,l=function(a,b){return a<<b|a>>>32-b},m=function(a,b){var c,d,e,f,g;return e=2147483648&a,f=2147483648&b,c=1073741824&a,d=1073741824&b,g=(1073741823&a)+(1073741823&b),c&d?2147483648^g^e^f:c|d?1073741824&g?3221225472^g^e^f:1073741824^g^e^f:g^e^f},n=function(a,b,c){return a&b|~a&c},o=function(a,b,c){return a&c|b&~c},p=function(a,b,c){return a^b^c},q=function(a,b,c){return b^(a|~c)},r=function(a,b,c,d,e,f,g){return a=m(a,m(m(n(b,c,d),e),g)),m(l(a,f),b)},s=function(a,b,c,d,e,f,g){return a=m(a,m(m(o(b,c,d),e),g)),m(l(a,f),b)},t=function(a,b,c,d,e,f,g){return a=m(a,m(m(p(b,c,d),e),g)),m(l(a,f),b)},u=function(a,b,c,d,e,f,g){return a=m(a,m(m(q(b,c,d),e),g)),m(l(a,f),b)},v=function(a){for(var b,c=a.length,d=c+8,e=(d-d%64)/64,f=16*(e+1),g=new Array(f-1),h=0,i=0;c>i;)b=(i-i%4)/4,h=i%4*8,g[b]=g[b]|a.charCodeAt(i)<<h,i++;return b=(i-i%4)/4,h=i%4*8,g[b]=g[b]|128<<h,g[f-2]=c<<3,g[f-1]=c>>>29,g},w=function(a){var b,c,d="",e="";for(c=0;3>=c;c++)b=a>>>8*c&255,e="0"+b.toString(16),d+=e.substr(e.length-2,2);return d},x=[],y=7,z=12,A=17,B=22,C=5,D=9,E=14,F=20,G=4,H=11,I=16,J=23,K=6,L=10,M=15,N=21;for(x=v(a),h=1732584193,i=4023233417,j=2562383102,k=271733878,b=x.length,c=0;b>c;c+=16)d=h,e=i,f=j,g=k,h=r(h,i,j,k,x[c+0],y,3614090360),k=r(k,h,i,j,x[c+1],z,3905402710),j=r(j,k,h,i,x[c+2],A,606105819),i=r(i,j,k,h,x[c+3],B,3250441966),h=r(h,i,j,k,x[c+4],y,4118548399),k=r(k,h,i,j,x[c+5],z,1200080426),j=r(j,k,h,i,x[c+6],A,2821735955),i=r(i,j,k,h,x[c+7],B,4249261313),h=r(h,i,j,k,x[c+8],y,1770035416),k=r(k,h,i,j,x[c+9],z,2336552879),j=r(j,k,h,i,x[c+10],A,4294925233),i=r(i,j,k,h,x[c+11],B,2304563134),h=r(h,i,j,k,x[c+12],y,1804603682),k=r(k,h,i,j,x[c+13],z,4254626195),j=r(j,k,h,i,x[c+14],A,2792965006),i=r(i,j,k,h,x[c+15],B,1236535329),h=s(h,i,j,k,x[c+1],C,4129170786),k=s(k,h,i,j,x[c+6],D,3225465664),j=s(j,k,h,i,x[c+11],E,643717713),i=s(i,j,k,h,x[c+0],F,3921069994),h=s(h,i,j,k,x[c+5],C,3593408605),k=s(k,h,i,j,x[c+10],D,38016083),j=s(j,k,h,i,x[c+15],E,3634488961),i=s(i,j,k,h,x[c+4],F,3889429448),h=s(h,i,j,k,x[c+9],C,568446438),k=s(k,h,i,j,x[c+14],D,3275163606),j=s(j,k,h,i,x[c+3],E,4107603335),i=s(i,j,k,h,x[c+8],F,1163531501),h=s(h,i,j,k,x[c+13],C,2850285829),k=s(k,h,i,j,x[c+2],D,4243563512),j=s(j,k,h,i,x[c+7],E,1735328473),i=s(i,j,k,h,x[c+12],F,2368359562),h=t(h,i,j,k,x[c+5],G,4294588738),k=t(k,h,i,j,x[c+8],H,2272392833),j=t(j,k,h,i,x[c+11],I,1839030562),i=t(i,j,k,h,x[c+14],J,4259657740),h=t(h,i,j,k,x[c+1],G,2763975236),k=t(k,h,i,j,x[c+4],H,1272893353),j=t(j,k,h,i,x[c+7],I,4139469664),i=t(i,j,k,h,x[c+10],J,3200236656),h=t(h,i,j,k,x[c+13],G,681279174),k=t(k,h,i,j,x[c+0],H,3936430074),j=t(j,k,h,i,x[c+3],I,3572445317),i=t(i,j,k,h,x[c+6],J,76029189),h=t(h,i,j,k,x[c+9],G,3654602809),k=t(k,h,i,j,x[c+12],H,3873151461),j=t(j,k,h,i,x[c+15],I,530742520),i=t(i,j,k,h,x[c+2],J,3299628645),h=u(h,i,j,k,x[c+0],K,4096336452),k=u(k,h,i,j,x[c+7],L,1126891415),j=u(j,k,h,i,x[c+14],M,2878612391),i=u(i,j,k,h,x[c+5],N,4237533241),h=u(h,i,j,k,x[c+12],K,1700485571),k=u(k,h,i,j,x[c+3],L,2399980690),j=u(j,k,h,i,x[c+10],M,4293915773),i=u(i,j,k,h,x[c+1],N,2240044497),h=u(h,i,j,k,x[c+8],K,1873313359),k=u(k,h,i,j,x[c+15],L,4264355552),j=u(j,k,h,i,x[c+6],M,2734768916),i=u(i,j,k,h,x[c+13],N,1309151649),h=u(h,i,j,k,x[c+4],K,4149444226),k=u(k,h,i,j,x[c+11],L,3174756917),j=u(j,k,h,i,x[c+2],M,718787259),i=u(i,j,k,h,x[c+9],N,3951481745),h=m(h,d),i=m(i,e),j=m(j,f),k=m(k,g);var O=w(h)+w(i)+w(j)+w(k);return O.toLowerCase()}};return a}]),angular.module("bugzoollaApp").run(["$templateCache",function(a){a.put("views/about.html",'<h2>it\'s pronounced: bug - zoo - oh - la</h2> <p>because:</p> <ul> <li>i made it up, so i get to say how it sounds. my ball, my rules.</li> <li>zoology is pronounced zoo - ah - lo - gee. you don\'t have a problem with that, do ya?</li> </ul> <h3>open source</h3> <p>bugzoolla is open source software, hosted <a href="https://github.com/grenade/bugzoolla">on github</a>. it\'s not all that complicated really. it\'s built on the shoulders of giants.</p> <ul> <li> the back end is <a href="https://www.bugzilla.org/">bugzilla</a> of course. that\'s a pretty complicated giant. without it, nothing here works. <ul> <li>i rely on the latest (5.1) version of bugzilla which has an almost modern, <a href="https://wiki.mozilla.org/Bugzilla:REST_API">rest</a> <a href="http://bugzilla.readthedocs.org/en/latest/api/index.html">api</a>.</li> <li>by default, bugzoolla connects to the bugzilla instance at <a href="https://bugzilla.mozilla.org/">bugzilla.mozilla.org</a>. you could probably point it at other instances of bugzilla, as long as they have the new restful api.</li> </ul> </li> <li> the front end is a bog standard, <a href="http://yeoman.io/">yeoman</a> (<a href="https://github.com/yeoman/generator-angular">generator-angular</a>) scaffolded web ui. i used it because, it\'s super easy to make it look like you know what you\'re doing. <ul> <li>the javascript framework that ties the front end to the back, is the almighty <a href="https://angularjs.org/">angularjs</a>.</li> <li>yeoman uses <a href="http://getbootstrap.com/">twitter bootsrap</a> to make everything look so darn pretty.</li> </ul> </li> </ul>'),a.put("views/bug-panel.html",'<div class="panel" ng-class="{ \'panel-danger\': bug.severity == \'critical\', \'panel-info\': bug.severity != \'critical\' }"> <div class="panel-heading"> <a ng-href="#/bug/{{bug.id}}" title="{{bug.creator_detail.real_name}}: {{bug.summary}}"> <gravatar data-email="bug.creator" data-size="20" data-default="identicon" ng-hide="verbose"></gravatar> <span ng-show="bug.is_open">{{bug.id}}</span> <s ng-hide="bug.is_open">{{bug.id}}</s> </a> <sup>{{bug.status.toLowerCase()}}</sup> <sub ng-show="verbose"><a href="http://bugzil.la/{{bug.id}}">bugzilla</a></sub> <i class="glyphicon pull-right" ng-click="bug.hidden=!bug.hidden" ng-class="{ \'glyphicon-minus-sign\': !bug.hidden, \'glyphicon-plus-sign\': bug.hidden }"></i> </div> <div class="panel-body" ng-hide="bug.hidden"> {{bug.summary}} <a href="" ng-repeat="tag in bug.tags"> <span class="label label-primary">{{tag}}</span> </a> <comment-panel comment="comment" index="{{$index}}" ng-repeat="comment in bug.comments"></comment-panel> </div> </div>'),a.put("views/bug.html",'<bug-panel bug="bug" verbose="true"></bug-panel>'),a.put("views/bugs-panel.html",'<div class="panel panel-default"> <div class="panel-heading"> {{title.replace(\'_\', \' \')}} <i class="glyphicon pull-right" ng-click="this.hidden=!this.hidden;setVisibility(title,this.hidden)" ng-class="{ \'glyphicon-minus-sign\': !this.hidden, \'glyphicon-plus-sign\': this.hidden }"></i> </div> <div class="panel-body"> <bug-panel bug="bug" ng-repeat="bug in bugs"></bug-panel> </div> </div>'),a.put("views/comment-panel.html",'<div class="panel panel-default"> <div class="panel-heading"> <a ng-href=""> <gravatar data-email="comment.creator" data-size="20" data-default="identicon"></gravatar> {{comment.creator}} </a> {{comment.time}} <i class="glyphicon pull-right" ng-click="comment.hidden=!comment.hidden" ng-class="{ \'glyphicon-minus-sign\': !comment.hidden, \'glyphicon-plus-sign\': comment.hidden }"></i> <span class="pull-right" style="margin-right: 10px"> <span ng-show="index==0">Description</span> <span ng-show="index>0">Comment {{index}}</span> </span> </div> <div class="panel-body" ng-hide="comment.hidden"> <pre style="background-color: white">{{comment.text}}</pre> </div> </div>'),a.put("views/dash.html",'<div class="row"> <form name="bugSearch" ng-submit="refresh(bugSearch)"> <div class="form-group col-md-4"> <label for="assignee" ng-show="search.advanced">assigned to:</label> <input type="email" class="form-control" placeholder="assignee" ng-model="search.assignee"> </div> <div class="form-group col-md-4" ng-show="search.advanced"> <label for="reporter" ng-show="search.advanced">reported by:</label> <input type="email" class="form-control" placeholder="reporter" ng-model="search.reporter"> </div> <div class="form-group col-md-4"> <label for="modified_after" ng-show="search.advanced">modified after:</label> <input type="date" class="form-control" ng-model="search.modified_after" ng-change="refresh(bugSearch)"> </div> <div class="form-group col-md-4" ng-show="search.advanced"> <label for="component" ng-show="search.advanced">component:</label> <input type="text" class="form-control" placeholder="component" ng-model="search.component"> </div> <div class="form-group col-md-4" ng-show="search.advanced"> <label for="whiteboard" ng-show="search.advanced">whiteboard:</label> <input type="text" class="form-control" placeholder="whiteboard" ng-model="search.whiteboard"> </div> <div class="form-group col-md-4" ng-show="search.advanced"> <label for="created_after" ng-show="search.advanced">created after:</label> <input type="date" class="form-control" ng-model="search.created_after" ng-change="refresh(bugSearch)"> </div> <div class="form-group col-md-4 pull-right"> <div ng-show="search.advanced">&nbsp;</div> <input type="submit" class="btn btn-primary" value="search bugzilla"> <i class="glyphicon pull-right" ng-click="search.advanced=!search.advanced" ng-class="{ \'glyphicon-minus-sign\': search.advanced, \'glyphicon-plus-sign\': !search.advanced }"></i> </div> </form> </div> <div class="row text-center" ng-show="loading_status"> <div>{{loading_status}}</div> <div class="progress" ng-show="count"> <div class="progress-bar" role="progressbar" aria-valuenow="{{((processed/count) * 100).toFixed(2)}}" aria-valuemin="0" aria-valuemax="100" style="width: {{((processed/count) * 100).toFixed(2)}}%"> <span class="sr-only">{{((processed/count) * 100).toFixed(2)}}% Complete</span> </div> </div> <div ng-show="!count"> <i class="glyphicon glyphicon-refresh glyphicon-spin"></i> </div> </div> <div class="row text-center"> <h4>Bugs <span ng-show="search.reporter">reported by <em>{{search.reporter}}</em></span> <span ng-show="search.assignee">assigned to <em>{{search.assignee}}</em></span> <span ng-show="search.component">in component <em>{{search.component}}</em></span> <span ng-show="search.whiteboard">with whiteboard tag <em>{{search.whiteboard}}</em></span> <span ng-show="search.created_after">created after <em>{{search.created_after.toLocaleDateString()}}</em></span> <span ng-show="search.modified_after">modified after <em>{{search.modified_after.toLocaleDateString()}}</em></span> </h4> </div> <div class="row"> <div class="col-md-3" ng-repeat="(title, list) in bugs"> <bugs-panel title="{{title}}" bugs="list"></bugs-panel> </div> </div>')}]);